# 📋 举报模块架构设计

> **基于纯结构架构图标准模板的举报系统完整设计文档**

## 📊 **模块概览**

### 🎯 **核心功能**
- **举报类型选择**：8种预设举报类型，单选模式
- **举报描述输入**：200字限制的多行文本输入
- **图片证据上传**：支持拍照和相册选择，最多9张图片
- **表单验证**：实时验证和提交前验证双重保障
- **提交确认**：确认对话框防止误操作

### 🏗️ **技术架构**
- **页面层级**：主页面 + 预览弹窗 + 确认对话框
- **状态管理**：表单验证状态 + 图片上传状态 + 提交状态
- **数据服务**：举报API + 图片上传 + 内容审核
- **用户体验**：实时反馈 + 动画效果 + 错误处理

---

## 🌳 举报模块 - 树状图（页面结构视角）

```
【举报系统模块】★★★
│
├── 【举报主页面】📱（复杂页面 - 白色背景）
│   ├── 📱 系统状态栏 (iOS适配 - 44px高度)
│   │   ├── 🕐 时间显示 "9:41" (左上角 - 16sp黑色)
│   │   ├── 📶 信号指示器 (右上角 - 4格信号强度)
│   │   ├── 📶 WiFi指示器 (右上角 - 连接状态)
│   │   └── 🔋 电池指示器 (右上角 - 满电状态黑色)
│   │
│   ├── 🔝 页面导航栏 (固定头部 - 高度56px - 白色背景)
│   │   ├── 🔙「<」返回按钮 (左上角 - 黑色箭头图标 24x24px)
│   │   │   ├── 图标样式：黑色线条箭头 + 2px线宽
│   │   │   ├── 点击区域：44x44px可点击区域
│   │   │   └── 点击效果：0.2s缩放动画 + 返回上级页面
│   │   ├── 📝 页面标题 "举报" (居中 - 18sp黑色粗体)
│   │   │   ├── 字体样式：PingFang SC粗体 + 居中对齐
│   │   │   └── 标题位置：导航栏中央垂直居中
│   │   └── 💜「提交」按钮 (右上角 - 紫色文字 16sp)
│   │       ├── 按钮样式：紫色#8A2BE2文字 + 无背景
│   │       ├── 按钮状态：默认禁用灰色，有内容时紫色可点击
│   │       ├── 点击效果：0.1s透明度变化
│   │       └── 提交功能：验证表单并提交举报信息
│   │
│   ├── 📋 举报类型选择区域 (主要功能区 - 顶部间距32px)
│   │   ├── 📝 区域标题 "请选择你要举报的类型" (左边距16px - 18sp黑色粗体)
│   │   │   ├── 标题样式：18sp黑色字体 + 左对齐
│   │   │   └── 底部间距：24px到选择区域
│   │   │
│   │   └── 《举报类型网格容器》📋 (2列网格布局)
│   │       ├── 💜《辱骂引战》📋 (左上角 - 选中状态卡片)
│   │       │   ├── 📱 卡片容器 (紫色边框 + 白色背景 + 圆角12px)
│   │       │   │   ├── 卡片尺寸：(屏幕宽度-48px)/2 x 56px
│   │       │   │   ├── 边框样式：2px紫色#8A2BE2边框
│   │       │   │   ├── 背景样式：白色背景 + 轻微阴影
│   │       │   │   └── 内边距：16px垂直 + 20px水平
│   │       │   ├── 📝 类型文字 "辱骂引战" (16sp紫色粗体)
│   │       │   │   ├── 文字样式：紫色#8A2BE2 + 粗体 + 居中对齐
│   │       │   │   └── 选中状态：紫色文字 + 紫色边框
│   │       │   ├── 点击区域：整个卡片可点击
│   │       │   ├── 点击效果：0.2s边框颜色变化 + 文字颜色变化
│   │       │   └── 选择功能：单选模式，选中后其他项取消选中
│   │       │
│   │       ├── 📋《色情低俗》📋 (右上角 - 未选中状态卡片)
│   │       │   ├── 📱 卡片容器 (灰色边框 + 白色背景 + 圆角12px)
│   │       │   │   ├── 边框样式：1px灰色#E0E0E0边框
│   │       │   │   └── 背景样式：白色背景 + 无阴影
│   │       │   ├── 📝 类型文字 "色情低俗" (16sp灰色常规)
│   │       │   │   ├── 文字样式：灰色#666666 + 常规字重 + 居中对齐
│   │       │   │   └── 未选中状态：灰色文字 + 灰色边框
│   │       │   └── 交互功能：点击选中，取消其他选项
│   │       │
│   │       ├── 📋《诈骗》📋 (左中 - 相同未选中样式)
│   │       ├── 📋《违法犯罪》📋 (右中 - 相同未选中样式)
│   │       ├── 📋《不实信息》📋 (左下 - 相同未选中样式)
│   │       ├── 📋《未成年人相关》📋 (右下 - 相同未选中样式)
│   │       ├── 📋《内容引人不适》📋 (左下2 - 相同未选中样式)
│   │       └── 📋《其他》📋 (右下2 - 相同未选中样式)
│   │
│   ├── 📝 举报描述输入区域 (中部区域 - 顶部间距40px)
│   │   ├── 📝 区域标题 "举报描述" (左边距16px - 18sp黑色粗体)
│   │   │   ├── 标题样式：18sp黑色字体 + 左对齐
│   │   │   └── 底部间距：16px到输入框
│   │   │
│   │   └── 《多行文本输入框》📋 (大型输入组件)
│   │       ├── 📱 输入框容器 (浅灰色背景 + 圆角12px)
│   │       │   ├── 容器尺寸：屏幕宽度-32px x 200px高度
│   │       │   ├── 背景样式：浅灰色#F5F5F5背景
│   │       │   ├── 边框样式：无边框设计
│   │       │   └── 内边距：16px全方向
│   │       ├── 📝 占位符文字 "请描述你举报的原因" (16sp浅灰色)
│   │       │   ├── 占位符样式：浅灰色#999999 + 16sp字体
│   │       │   ├── 显示逻辑：输入框为空时显示
│   │       │   └── 位置：输入框左上角起始位置
│   │       ├── 📝 用户输入文字 (16sp黑色)
│   │       │   ├── 输入文字样式：黑色#333333 + 16sp + 1.4倍行高
│   │       │   ├── 文字换行：自动换行 + 多行显示
│   │       │   └── 光标样式：紫色光标 + 1px宽度
│   │       ├── 📊 字数统计 "0/200" (右下角 - 12sp灰色)
│   │       │   ├── 统计样式：灰色#999999 + 12sp + 右对齐
│   │       │   ├── 统计位置：输入框右下角内部8px间距
│   │       │   ├── 实时更新：输入时实时更新字数
│   │       │   └── 超限提示：超过200字时红色显示
│   │       └── 输入控制
│   │           ├── 最大字符限制：200字符
│   │           ├── 输入监听：实时字数统计 + 提交按钮状态更新
│   │           └── 键盘类型：默认键盘 + 自动大写关闭
│   │
│   ├── 🖼️ 图片上传区域 (底部区域 - 顶部间距32px)
│   │   ├── 📝 区域标题 "上传图片" (左边距16px - 18sp黑色粗体)
│   │   │   ├── 标题样式：18sp黑色字体 + 左对齐
│   │   │   ├── 📝 可选标识 "(选填)" (标题右侧 - 14sp灰色)
│   │   │   │   ├── 标识样式：灰色#999999 + 14sp + 常规字重
│   │   │   │   └── 标识位置：标题文字右侧8px间距
│   │   │   └── 底部间距：16px到图片区域
│   │   │
│   │   └── 《图片展示容器》📋 (水平滚动容器)
│   │       ├── 🖼️ 已上传图片 (左侧 - 圆角方形)
│   │       │   ├── 📱 图片容器 (方形120x120px + 圆角12px)
│   │       │   │   ├── 容器样式：白色背景 + 1px灰色边框
│   │       │   │   ├── 图片显示：等比缩放 + 居中裁剪
│   │       │   │   └── 加载状态：占位图 + 渐进式加载
│   │       │   ├── 📷 图片内容 (用户头像照片)
│   │       │   │   ├── 图片处理：自动压缩 + 格式优化
│   │       │   │   ├── 图片质量：最大2MB + JPEG格式
│   │       │   │   └── 点击功能：放大预览 + 删除选项
│   │       │   ├── ❌ 删除按钮 (右上角 - 红色圆形)
│   │       │   │   ├── 按钮样式：红色#FF4444圆形背景 + 白色X图标
│   │       │   │   ├── 按钮尺寸：20x20px + 右上角-6px偏移
│   │       │   │   ├── 点击效果：0.2s缩放动画
│   │       │   │   └── 删除功能：确认对话框 + 移除图片
│   │       │   └── 🔍 预览功能：点击图片全屏查看
│   │       │
│   │       └── ➕ 添加图片按钮 (右侧 - 虚线边框)
│   │           ├── 📱 按钮容器 (方形120x120px + 圆角12px)
│   │           │   ├── 容器样式：透明背景 + 2px虚线灰色边框
│   │           │   ├── 边框样式：虚线#CCCCCC + 8px虚线间隔
│   │           │   └── 内部布局：垂直居中对齐
│   │           ├── ➕ 加号图标 (中央 - 灰色加号)
│   │           │   ├── 图标样式：灰色#999999 + 32x32px + 粗体线条
│   │           │   ├── 图标位置：容器正中央
│   │           │   └── 图标效果：点击时0.2s缩放动画
│   │           ├── 点击区域：整个按钮容器可点击
│   │           ├── 点击效果：0.1s背景色变化 + 缩放动画
│   │           └── 上传功能：
│   │               ├── 相机拍照：调用系统相机
│   │               ├── 相册选择：打开系统相册
│   │               ├── 多选支持：最多9张图片
│   │               └── 格式限制：JPG/PNG + 最大10MB
│   │
│   └── 📱 底部安全区域 (iPhone适配 - 34px高度)
│       └── 底部留白：确保内容不被Home Indicator遮挡
│
├── 【图片预览弹窗】📱 (全屏模态弹窗)
│   ├── 🌐 遮罩层 (半透明黑色背景)
│   │   ├── 遮罩样式：黑色背景 + 80%透明度
│   │   ├── 点击功能：点击空白区域关闭弹窗
│   │   └── 动画效果：0.3s渐入渐出
│   ├── 🖼️ 图片展示区域 (中央显示)
│   │   ├── 📷 放大图片 (等比缩放 + 手势支持)
│   │   │   ├── 图片样式：保持原始比例 + 适应屏幕
│   │   │   ├── 手势支持：双击放大 + 捏合缩放 + 拖拽移动
│   │   │   └── 缩放范围：0.5x到3x缩放倍数
│   │   └── 🔄 加载状态 (图片加载中显示)
│   └── 🔧 操作按钮区域 (底部固定)
│       ├── ❌「删除」按钮 (红色背景 + 白色文字)
│       ├── 💾「保存」按钮 (蓝色背景 + 白色文字)
│       └── ✖️「关闭」按钮 (右上角 + 白色X图标)
│
├── 【提交确认弹窗】📱 (模态对话框)
│   ├── 📋 对话框容器 (白色背景 + 圆角16px)
│   │   ├── 容器样式：白色背景 + 圆角16px + 阴影8px
│   │   ├── 容器尺寸：280x200px + 屏幕居中
│   │   └── 动画效果：0.3s缩放弹出
│   ├── 📝 标题文字 "确认提交举报？" (18sp黑色粗体)
│   ├── 📝 描述文字 "提交后我们会尽快处理" (14sp灰色)
│   └── 🔧 按钮组 (底部水平排列)
│       ├── 🔘「取消」按钮 (灰色边框 + 灰色文字)
│       └── 💜「确认」按钮 (紫色背景 + 白色文字)
│
└── 🔧 系统支持层
    ├── 📡 数据服务
    │   ├── 「举报提交API」(注：提交举报信息到服务器)
    │   ├── 「图片上传服务」(注：图片压缩和云端存储)
    │   └── 「内容审核服务」(注：举报内容预审核)
    ├── 🔐 安全服务
    │   ├── 「用户身份验证」(注：确保举报者身份真实)
    │   ├── 「防刷机制」(注：限制恶意举报频率)
    │   └── 「数据加密」(注：举报内容加密传输)
    └── 📊 监控服务
        ├── 「举报统计」(注：举报数据统计分析)
        ├── 「处理追踪」(注：举报处理状态跟踪)
        └── 「用户行为分析」(注：举报行为模式分析)
```

---

## 🔄 举报模块 - 流程图（用户操作视角）

```
开始
 ↓
【进入举报页面】
 ├─→ 从内容详情页点击举报按钮
 ├─→ 从用户资料页点击举报选项
 └─→ 从消息页面举报用户
 ↓
【举报页面初始化】
 ↓
页面数据加载
 ├─→ 加载举报类型选项列表
 ├─→ 初始化表单验证规则
 ├─→ 设置图片上传配置
 └─→ 检查用户举报权限
 ↓
用户操作选择
 ├─→ 【选择举报类型】（必选操作 - 单选模式）
 │    ↓
 │   【举报类型选择操作】
 │    ├─→ 浏览举报类型选项
 │    │    ├─→ 查看"辱骂引战"选项
 │    │    ├─→ 查看"色情低俗"选项
 │    │    ├─→ 查看"诈骗"选项
 │    │    ├─→ 查看"违法犯罪"选项
 │    │    ├─→ 查看"不实信息"选项
 │    │    ├─→ 查看"未成年人相关"选项
 │    │    ├─→ 查看"内容引人不适"选项
 │    │    └─→ 查看"其他"选项
 │    ├─→ 点击选择举报类型
 │    │    ├─→ 点击"辱骂引战" → 选中状态（紫色边框+文字）
 │    │    ├─→ 点击其他类型 → 切换选中状态
 │    │    └─→ 选中效果：0.2s边框和文字颜色变化动画
 │    └─→ 类型选择完成 → 启用提交按钮（如有描述内容）
 │
 ├─→ 【填写举报描述】（必填操作 - 多行文本输入）
 │    ↓
 │   【举报描述输入操作】
 │    ├─→ 点击输入框开始输入
 │    │    ├─→ 输入框获得焦点 → 显示光标
 │    │    ├─→ 占位符文字消失 → 显示输入内容
 │    │    └─→ 弹出系统键盘 → 开始文字输入
 │    ├─→ 输入举报原因描述
 │    │    ├─→ 实时字数统计更新 → "X/200"显示
 │    │    ├─→ 文字自动换行 → 多行内容显示
 │    │    ├─→ 超过200字限制 → 字数统计变红色
 │    │    └─→ 输入验证：实时检查内容合规性
 │    ├─→ 描述内容完成
 │    │    ├─→ 字数在1-200字范围内 → 验证通过
 │    │    ├─→ 内容包含有效信息 → 质量检查通过
 │    │    └─→ 触发表单验证 → 更新提交按钮状态
 │    └─→ 输入框失去焦点 → 保存草稿内容
 │
 ├─→ 【上传图片证据】（可选操作 - 多图片上传）
 │    ↓
 │   【图片上传操作流程】
 │    ├─→ 点击"+"添加图片按钮
 │    │    ├─→ 按钮点击效果 → 0.2s缩放动画
 │    │    └─→ 弹出图片来源选择菜单
 │    │         ├─→ 选择"拍照" → 调用系统相机
 │    │         │    ├─→ 相机权限检查 → 请求权限（如未授权）
 │    │         │    ├─→ 打开相机界面 → 用户拍照
 │    │         │    ├─→ 拍照完成 → 预览确认
 │    │         │    └─→ 确认使用 → 返回举报页面
 │    │         └─→ 选择"从相册选择" → 打开系统相册
 │    │              ├─→ 相册权限检查 → 请求权限（如未授权）
 │    │              ├─→ 浏览相册图片 → 选择目标图片
 │    │              ├─→ 多选支持 → 最多选择9张图片
 │    │              └─→ 确认选择 → 返回举报页面
 │    ├─→ 图片上传处理
 │    │    ├─→ 图片压缩优化 → 控制文件大小
 │    │    ├─→ 格式转换处理 → 统一JPEG格式
 │    │    ├─→ 上传到云端存储 → 显示上传进度
 │    │    ├─→ 上传成功 → 显示图片缩略图
 │    │    └─→ 上传失败 → 显示错误提示 + 重试选项
 │    ├─→ 图片管理操作
 │    │    ├─→ 点击图片预览 → 【全屏预览弹窗】
 │    │    │    ├─→ 显示大图 → 支持手势缩放
 │    │    │    ├─→ 双击放大 → 捏合缩放手势
 │    │    │    ├─→ 拖拽移动 → 查看图片细节
 │    │    │    └─→ 点击关闭 → 返回举报页面
 │    │    ├─→ 点击删除按钮 → 确认删除图片
 │    │    │    ├─→ 弹出确认对话框 → "确认删除这张图片？"
 │    │    │    ├─→ 点击"确认" → 删除图片 + 更新界面
 │    │    │    └─→ 点击"取消" → 保持图片不变
 │    │    └─→ 继续添加图片 → 重复上传流程（最多9张）
 │    └─→ 图片上传完成 → 更新表单验证状态
 │
 ├─→ 【表单验证检查】（自动触发 - 实时验证）
 │    ↓
 │   【表单完整性验证】
 │    ├─→ 举报类型验证
 │    │    ├─→ 已选择类型 → 验证通过 ✅
 │    │    └─→ 未选择类型 → 验证失败 ❌ 提交按钮禁用
 │    ├─→ 举报描述验证
 │    │    ├─→ 描述内容1-200字 → 验证通过 ✅
 │    │    ├─→ 描述为空 → 验证失败 ❌ 提交按钮禁用
 │    │    └─→ 描述超过200字 → 验证失败 ❌ 字数统计红色
 │    ├─→ 图片内容验证（可选）
 │    │    ├─→ 无图片 → 跳过验证 ✅
 │    │    ├─→ 有图片且格式正确 → 验证通过 ✅
 │    │    └─→ 图片格式错误 → 验证失败 ❌ 显示错误提示
 │    └─→ 综合验证结果
 │         ├─→ 所有必填项验证通过 → 提交按钮变为紫色可点击
 │         └─→ 存在验证失败项 → 提交按钮保持灰色禁用
 │
 └─→ 【提交举报信息】（最终操作 - 数据提交）
      ↓
     【举报提交流程】
      ├─→ 点击"提交"按钮
      │    ├─→ 按钮点击效果 → 0.1s透明度变化
      │    ├─→ 最终表单验证 → 确保数据完整性
      │    └─→ 弹出提交确认对话框
      │         ├─→ 显示确认弹窗 → "确认提交举报？"
      │         ├─→ 说明文字 → "提交后我们会尽快处理"
      │         ├─→ 点击"取消" → 关闭弹窗 + 继续编辑
      │         └─→ 点击"确认" → 执行提交操作
      ├─→ 数据提交处理
      │    ├─→ 显示提交loading状态 → 按钮显示加载动画
      │    ├─→ 数据打包上传 → 举报类型+描述+图片
      │    ├─→ 服务器接收验证 → 数据格式和内容检查
      │    ├─→ 内容安全审核 → 自动过滤敏感信息
      │    └─→ 生成举报记录 → 分配唯一举报ID
      ├─→ 提交结果处理
      │    ├─→ 提交成功
      │    │    ├─→ 显示成功提示 → "举报提交成功"
      │    │    ├─→ 提示处理时间 → "我们会在24小时内处理"
      │    │    ├─→ 提供举报编号 → 方便后续查询
      │    │    └─→ 自动返回上级页面 → 2秒后自动关闭
      │    └─→ 提交失败
      │         ├─→ 网络错误 → 显示"网络连接失败，请重试"
      │         ├─→ 服务器错误 → 显示"提交失败，请稍后重试"
      │         ├─→ 内容违规 → 显示"举报内容不符合规范"
      │         └─→ 频率限制 → 显示"举报过于频繁，请稍后再试"
      └─→ 后续处理流程
           ├─→ 举报记录存储 → 数据库永久保存
           ├─→ 通知审核团队 → 推送待处理任务
           ├─→ 用户行为记录 → 统计举报行为数据
           └─→ 自动风控检测 → 识别恶意举报行为
 ↓
【举报流程完成或异常处理】
 ├─→ 正常完成流程
 │    ├─→ 举报提交成功 → 返回来源页面
 │    ├─→ 更新用户举报历史 → 记录举报行为
 │    └─→ 等待官方处理结果 → 后续通知用户
 ├─→ 用户主动退出
 │    ├─→ 点击返回按钮 → 确认是否保存草稿
 │    ├─→ 保存草稿 → 下次进入时恢复内容
 │    └─→ 放弃举报 → 清空所有输入内容
 └─→ 系统异常处理
      ├─→ 应用崩溃 → 自动保存草稿 + 错误日志上报
      ├─→ 网络中断 → 缓存数据 + 网络恢复后重试
      └─→ 权限不足 → 引导用户开启必要权限
 ↓
结束
```

---

## 🎨 **设计要点**

### 📱 **UI设计标准**
- **色彩系统**：主色紫色#8A2BE2，辅助色灰色#666666，错误色红色#FF4444
- **字体规范**：PingFang SC，标题18sp粗体，正文16sp常规，辅助文字14sp
- **圆角标准**：卡片12px，按钮8px，图片容器12px
- **间距系统**：16px基础间距，24px区域间距，32px大区域间距

### 🔧 **交互设计**
- **状态反馈**：0.2s动画时长，按钮点击缩放效果，颜色过渡动画
- **表单验证**：实时验证 + 提交前验证，错误状态红色提示
- **图片上传**：支持拍照和相册，最多9张，自动压缩优化
- **确认机制**：重要操作二次确认，防止误操作

### 🛡️ **安全设计**
- **内容审核**：提交前预审核，敏感词过滤
- **防刷机制**：限制举报频率，识别恶意行为
- **数据加密**：敏感信息加密传输和存储
- **权限控制**：相机和相册权限管理

---

## 🔧 **技术实现**

### 📋 **组件架构**
```typescript
// 举报页面主组件
ReportScreen
├── ReportHeader (导航栏组件)
├── ReportTypeSelector (举报类型选择组件)
├── ReportDescriptionInput (描述输入组件)
├── ImageUploader (图片上传组件)
├── ImagePreviewModal (图片预览弹窗)
└── SubmitConfirmModal (提交确认弹窗)
```

### 🗂️ **状态管理**
```typescript
interface ReportState {
  selectedType: ReportType | null;
  description: string;
  images: ImageData[];
  isSubmitting: boolean;
  validationErrors: ValidationError[];
}
```

### 📡 **API接口**
```typescript
// 举报提交接口
POST /api/reports
{
  type: string;
  description: string;
  images: string[];
  targetId: string;
  targetType: 'user' | 'content';
}

// 图片上传接口
POST /api/upload/images
FormData: {
  files: File[];
  category: 'report';
}
```

---

## 📊 **质量评估**

### ✅ **功能完整性**
- [x] 举报类型选择（8种类型）
- [x] 举报描述输入（200字限制）
- [x] 图片证据上传（最多9张）
- [x] 表单验证（实时+提交前）
- [x] 提交确认（防误操作）
- [x] 错误处理（网络+业务异常）

### 🎯 **用户体验**
- [x] 界面简洁清晰，操作流程顺畅
- [x] 实时反馈，状态提示明确
- [x] 动画效果自然，响应速度快
- [x] 错误提示友好，指导用户操作

### 🔒 **安全性**
- [x] 内容审核机制完善
- [x] 防刷和风控策略
- [x] 数据加密传输
- [x] 用户权限控制

### 📱 **技术质量**
- [x] 组件化设计，代码复用性高
- [x] 状态管理清晰，数据流向明确
- [x] 错误边界处理完善
- [x] 性能优化，内存管理良好

---

**📝 文档版本**：v1.0  
**🗓️ 创建时间**：2024年12月  
**👥 适用团队**：产品、设计、开发、测试  
**🎯 应用场景**：移动端举报功能完整实现**
